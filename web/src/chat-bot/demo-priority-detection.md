# 内容类型检测优先级演示

## 优先级说明

聊天机器人现在采用智能的内容类型检测优先级，确保换行符能够正确显示：

### 优先级顺序

1. **换行符 (\n)** - 最高优先级

   - 如果内容包含换行符，优先识别为 `text` 类型
   - 确保换行符能够正确转换为 `<br>` 标签显示

2. **Markdown 语法** - 中等优先级

   - 包含 Markdown 语法但不包含换行符的内容
   - 识别为 `markdown` 类型

3. **HTML 标签** - 最低优先级
   - 包含 HTML 标签但不包含换行符和 Markdown 语法的内容
   - 识别为 `html` 类型

## 测试用例

### 测试1：换行符优先级（最高）

```javascript
// 输入内容
const content = '第一行\n第二行\n第三行';

// 检测结果：text 类型
// 渲染结果：换行符转换为 <br> 标签
```

### 测试2：Markdown + 换行符

```javascript
// 输入内容
const content = '# 标题\n\n**粗体文本**\n\n- 列表项1\n- 列表项2';

// 检测结果：text 类型（因为有换行符）
// 渲染结果：换行符转换为 <br> 标签，Markdown 语法不生效
```

### 测试3：纯 Markdown（无换行符）

```javascript
// 输入内容
const content = '# 标题\n\n**粗体文本**\n\n- 列表项1\n- 列表项2';

// 检测结果：markdown 类型
// 渲染结果：Markdown 语法生效，换行符按 Markdown 规则处理
```

## 实际应用场景

### 场景1：用户输入包含换行符的消息

```javascript
// 用户输入
'你好！\n我想问一个问题\n\n谢谢！';

// 系统检测为 text 类型
// 正确显示换行
```

### 场景2：机器人回复包含思考过程

```javascript
// 机器人回复
'<think>\n让我思考一下这个问题...\n</think>\n\n根据我的分析，答案是...';

// 系统检测为 text 类型
// 换行符正确显示，HTML 标签作为普通文本显示
```

## 优势

1. **确保换行符显示**：包含换行符的内容优先识别为文本类型
2. **保持 Markdown 功能**：纯 Markdown 内容仍能正确渲染
3. **支持 HTML 标签**：纯 HTML 内容仍能正确渲染
4. **向后兼容**：不影响现有功能
5. **智能检测**：自动选择最合适的渲染方式
